<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Class 11 : Python Idioms &mdash; Genome Informatics Workshop 0.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Genome Informatics Workshop 0.2 documentation" href="../index.html" />
    <link rel="up" title="Class list" href="../Classes.html" />
    <link rel="next" title="Class 12 : The ENCODE Project" href="class-12.html" />
    <link rel="prev" title="Class 10 : Applied Python" href="class-10.html" /> 

<!-- Google Analytics tracking code -->
<!--        DO NOT REMOVE           -->
<!--           JRH                  -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47837611-1', 'ucd-bioworkshop.github.io');
  ga('send', 'pageview');

</script>


  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/my_logo.png">
          Genome Informatics Workshop</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://hesselberthlab.github.io">Hesselberth lab</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Genome Informatics Workshop <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Classes.html">Class list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problem_Sets.html">Problem Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous.html">Miscellaneous</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Class 11 : Python Idioms</a><ul>
<li><a class="reference internal" href="#goals">Goals</a></li>
<li><a class="reference internal" href="#variable-names-vs-builtins">Variable Names Vs. Builtins</a></li>
<li><a class="reference internal" href="#fastq-parsing">FASTQ parsing</a></li>
<li><a class="reference internal" href="#enumerate">enumerate</a></li>
<li><a class="reference internal" href="#modulo">modulo</a></li>
<li><a class="reference internal" href="#modulo-and-enumerate">modulo and enumerate</a></li>
<li><a class="reference internal" href="#modulo-enumerate-fastq">modulo, enumerate, fastq</a></li>
<li><a class="reference internal" href="#modulo-enumerate-fastq-parse">modulo, enumerate, fastq: parse</a></li>
<li><a class="reference internal" href="#zip">zip</a></li>
<li><a class="reference internal" href="#izip">izip</a></li>
<li><a class="reference internal" href="#izip-laziness">izip laziness</a></li>
<li><a class="reference internal" href="#list-comprehensions">list comprehensions</a></li>
<li><a class="reference internal" href="#why-use-functions">Why use functions?</a></li>
<li><a class="reference internal" href="#in-class-exercise">in-class exercise</a></li>
<li><a class="reference internal" href="#exercises">exercises</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="class-11-python-idioms">
<h1>Class 11 : Python Idioms<a class="headerlink" href="#class-11-python-idioms" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#class-11-python-idioms" title="Slides">§</a></h1>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#goals" title="Slides">§</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li>python tricks to write more concise code</li>
<li>Laziness</li>
<li>Data structures</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="variable-names-vs-builtins">
<h2>Variable Names Vs. Builtins<a class="headerlink" href="#variable-names-vs-builtins" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#variable-names-vs-builtins" title="Slides">§</a></h2>
<p>you decide what to call a variable in a for loop or the name of
a list or dictionary.</p>
<p>There are python keywords and builtin functions</p>
<p>list of keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">keyword</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keyword</span><span class="o">.</span><span class="n">kwlist</span><span class="p">)</span>
<span class="go">and as assert break class continue def del elif else except exec</span>
<span class="go">finally for from global if import in is lambda not or pass print</span>
<span class="go">raise return try while with yield</span>
</pre></div>
</div>
<p>list of builtin functions:</p>
<blockquote>
<div><a class="reference external" href="http://docs.python.org/2/library/functions.html">http://docs.python.org/2/library/functions.html</a></div></blockquote>
<p>(includes range, open, file, list, dict, etc)</p>
</div>
<div class="section" id="fastq-parsing">
<h2>FASTQ parsing<a class="headerlink" href="#fastq-parsing" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#fastq-parsing" title="Slides">§</a></h2>
<p>We have seen the problem of parsing a FASTQ file.
How do we describe the format in English?</p>
<blockquote>
<div>FASTQ records occur in groups of 4 in the order: name, seq, plus, qual</div></blockquote>
<p>We will learn some tools to simplify this.</p>
</div>
<div class="section" id="enumerate">
<h2>enumerate<a class="headerlink" href="#enumerate" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#enumerate" title="Slides">§</a></h2>
<p>We have seen that we often want to know the index (or line number)
that goes with an iterable. For example, if we know
that we are on the first line, we can skip the header.</p>
<p>We can know the index of an iterable with enumerate:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">names</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;fred&#39;</span><span class="p">,</span> <span class="s">&#39;sally&#39;</span><span class="p">,</span> <span class="s">&#39;harry&#39;</span><span class="p">,</span> <span class="s">&#39;jack&#39;</span><span class="p">,</span> <span class="s">&#39;texan&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span>

<span class="c"># To illustrate the freedom you have in choosing variable names</span>
<span class="c"># the above is identical to</span>
<span class="k">for</span> <span class="n">really_bad_var_name</span><span class="p">,</span> <span class="n">x42</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">really_bad_var_name</span><span class="p">,</span> <span class="n">x42</span>
</pre></div>
</div>
<p>Try this in the ipython terminal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">enumerate</span><span class="p">(</span><span class="s">&quot;abcdefg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Enumerate is lazy, meaning it won&#8217;t consume an iterable until we ask it to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="s">&quot;abcdefg&quot;</span><span class="p">))</span>
<span class="c"># OR</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s">&quot;abcdefg&quot;</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">letter</span>
<span class="c"># remember we have our choice of variable names. The above is identical to</span>
<span class="k">for</span> <span class="n">xx</span><span class="p">,</span> <span class="n">hello</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s">&quot;abcdefg&quot;</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">xx</span><span class="p">,</span> <span class="n">hello</span>
</pre></div>
</div>
<p>Generally we name index variables as <em>i</em> and give the other variables names that
make sense.</p>
<p>When we wrap any iterable in enumerate and we get a tuple of
<cite>index, thing</cite>. Where <cite>thing</cite> was the element of the original list.</p>
<p>We can skip the header in a file like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;/opt/bio-workshop/data/lamina.bed&#39;</span><span class="p">)):</span>
    <span class="c"># skip the header</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="c"># or we can get the variables directly since</span>
    <span class="c"># we know there are 4 cols</span>
    <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using enumerate like this is safer than manually incrementing a variable
as sometimes you will forget to increment or you will <em>continue</em> before
incrementing.</p>
</div>
<div class="section" id="modulo">
<h2>modulo<a class="headerlink" href="#modulo" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#modulo" title="Slides">§</a></h2>
<p>Modulo is the remainder operation.</p>
<ul class="simple">
<li>12 modulo 4 is 0</li>
<li>13 modulo 4 is 1</li>
</ul>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="mi">12</span> <span class="o">%</span> <span class="mi">4</span>
<span class="gh">Out[1]: </span><span class="go">0</span>

<span class="gp">In [2]: </span><span class="mi">13</span> <span class="o">%</span> <span class="mi">4</span>
<span class="gh">Out[2]: </span><span class="go">1</span>
</pre></div>
</div>
</div>
<div class="section" id="modulo-and-enumerate">
<h2>modulo and enumerate<a class="headerlink" href="#modulo-and-enumerate" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#modulo-and-enumerate" title="Slides">§</a></h2>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [3]: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
<span class="gp">   ...: </span>    <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span>
<span class="gp">   ...: </span>
<span class="go">0 0</span>
<span class="go">1 1</span>
<span class="go">2 2</span>
<span class="go">3 3</span>
<span class="go">4 0</span>
<span class="go">5 1</span>
<span class="go">6 2</span>
<span class="go">7 3</span>
<span class="go">8 0</span>
<span class="go">9 1</span>
<span class="go">10 2</span>
<span class="go">11 3</span>
</pre></div>
</div>
<p>How does this relate to our FASTQ?</p>
</div>
<div class="section" id="modulo-enumerate-fastq">
<h2>modulo, enumerate, fastq<a class="headerlink" href="#modulo-enumerate-fastq" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#modulo-enumerate-fastq" title="Slides">§</a></h2>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [4]: </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;misc/data/SP1.fq&#39;</span><span class="p">)):</span>
<span class="gp">   ...: </span>    <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="gp">   ...: </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">   ...: </span>
<span class="go">0 0 @cluster_2:UMI_ATTCCG</span>
<span class="go">1 1 TTTCCGGGGCACATAATCTTCAGCCGGGCGC</span>
<span class="go">2 2 +</span>
<span class="go">3 3 9C;=;=&lt;9@4868&gt;9:67AA&lt;9&gt;65&lt;=&gt;591</span>
<span class="go">4 0 @cluster_8:UMI_CTTTGA</span>
<span class="go">5 1 TATCCTTGCAATACTCTCCGAACGGGAGAGC</span>
<span class="go">6 2 +</span>
<span class="go">7 3 1/04.72,(003,-2-22+00-12./.-.4-</span>
<span class="go">8 0 @cluster_12:UMI_GGTCAA</span>
<span class="go">9 1 GCAGTTTAAGATCATTTTATTGAAGAGCAAG</span>
</pre></div>
</div>
</div>
<div class="section" id="modulo-enumerate-fastq-parse">
<h2>modulo, enumerate, fastq: parse<a class="headerlink" href="#modulo-enumerate-fastq-parse" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#modulo-enumerate-fastq-parse" title="Slides">§</a></h2>
<p>Parse a fastq!!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;/opt/bio-workshop/data/SP1.fq&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">qual</span> <span class="o">=</span> <span class="n">line</span>
        <span class="c"># here have name, seq, qual from a single record</span>
</pre></div>
</div>
<p>note how this fairly closely matches our english explanation of the fastq
format.</p>
</div>
<div class="section" id="zip">
<h2>zip<a class="headerlink" href="#zip" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#zip" title="Slides">§</a></h2>
<p>zip is another python function. It merges items from multiple lists:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [5]: </span><span class="n">a</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">b</span> <span class="o">=</span> <span class="s">&quot;abcde&quot;</span>

<span class="gp">In [7]: </span><span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">[(0, &#39;a&#39;), (1, &#39;b&#39;), (2, &#39;c&#39;), (3, &#39;d&#39;), (4, &#39;e&#39;)]</span>

<span class="gp">In [8]: </span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(),</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;world&quot;</span><span class="p">]</span>

<span class="gp">In [9]: </span><span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">[(0, &#39;a&#39;, {}),</span>
<span class="go"> (1, &#39;b&#39;, []),</span>
<span class="go"> (2, &#39;c&#39;, None),</span>
<span class="go"> (3, &#39;d&#39;, &#39;hello&#39;),</span>
<span class="go"> (4, &#39;e&#39;, &#39;world&#39;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="izip">
<h2>izip<a class="headerlink" href="#izip" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#izip" title="Slides">§</a></h2>
<blockquote>
<div>izip is a lazy version of zip. It doesn&#8217;t consume or return elements until you
ask for them.</div></blockquote>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>

<span class="gp">In [11]: </span><span class="n">seq</span> <span class="o">=</span> <span class="s">&quot;TTTCCGGGGCACATAATCTTCAGCCGGGCGC&quot;</span>

<span class="gp">In [12]: </span><span class="n">qual</span> <span class="o">=</span> <span class="s">&quot;9C;=;=&lt;9@4868&gt;9:67AA&lt;9&gt;65&lt;=&gt;591&quot;</span>

<span class="gp">In [13]: </span><span class="n">izip</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">qual</span><span class="p">)</span>
<span class="gh">Out[13]: </span><span class="go">&lt;itertools.izip at 0x10aa74368&gt;</span>

<span class="gp">In [14]: </span><span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">base_qual</span> <span class="ow">in</span> <span class="n">izip</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">qual</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">print</span> <span class="n">base</span><span class="p">,</span> <span class="n">base_qual</span>
<span class="gp">   ....: </span>
<span class="go">T 9</span>
<span class="go">T C</span>
<span class="go">T ;</span>
<span class="go">C =</span>
<span class="go">C ;</span>
<span class="go">G =</span>
<span class="go">G &lt;</span>
<span class="go">G 9</span>
<span class="go">G @</span>
<span class="go">C 4</span>
<span class="go">A 8</span>
<span class="go">C 6</span>
<span class="go">A 8</span>
<span class="go">T &gt;</span>
<span class="go">A 9</span>
<span class="go">A :</span>
<span class="go">T 6</span>
<span class="go">C 7</span>
<span class="go">T A</span>
<span class="go">T A</span>
<span class="go">C &lt;</span>
<span class="go">A 9</span>
<span class="go">G &gt;</span>
<span class="go">C 6</span>
<span class="go">C 5</span>
<span class="go">G &lt;</span>
<span class="go">G =</span>
<span class="go">G &gt;</span>
<span class="go">C 5</span>
<span class="go">G 9</span>
<span class="go">C 1</span>
</pre></div>
</div>
</div>
<div class="section" id="izip-laziness">
<h2>izip laziness<a class="headerlink" href="#izip-laziness" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#izip-laziness" title="Slides">§</a></h2>
<p>Laziness is important, if for example we are zipping over a file. If we use
<strong>zip</strong> it will consume the entire file immediately and read it into memory.
<strong>izip</strong> will only consume the file as we request the zipped items.</p>
<p>Note that in the previous slide, we associated each base with it&#8217;s base-quality.
That&#8217;s useful...</p>
</div>
<div class="section" id="list-comprehensions">
<h2>list comprehensions<a class="headerlink" href="#list-comprehensions" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#list-comprehensions" title="Slides">§</a></h2>
<p>In one problem you had to sum the ord()&#8217;s of the quality line.
The common way to do that was this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">qual_sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qual</span><span class="p">:</span>
    <span class="n">qual_sum</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Once could get the quals instead as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">integer_quals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qual</span><span class="p">]</span>
</pre></div>
</div>
<p>So the sum can be shortened to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">qual_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qual</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="why-use-functions">
<h2>Why use functions?<a class="headerlink" href="#why-use-functions" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#why-use-functions" title="Slides">§</a></h2>
<p>Functions are useful for encapsulating reusable chunks of code. For
exmaple, you don&#8217;t want to write messy code for parsing a fastq file every
time you need to parse a fastq file. Instead, you define a function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_fastq</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c"># parse records</span>
</pre></div>
</div>
<p>Once that is defined, you can put it in a file in your PYTHONPATH called
<tt class="docutils literal"><span class="pre">mytools.py</span></tt> and use it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># look ma! no messy parsing code!</span>
<span class="kn">from</span> <span class="nn">mytools</span> <span class="kn">import</span> <span class="n">parse_fastq</span>

<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">parse_fastq</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c"># use the record</span>
</pre></div>
</div>
</div>
<div class="section" id="in-class-exercise">
<h2>in-class exercise<a class="headerlink" href="#in-class-exercise" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#in-class-exercise" title="Slides">§</a></h2>
<p>calculate mean base-quality by base.</p>
<p>zip quality with sequence. append quality for each base in a dict of lists</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># append all quality scores for A base to quals_by_base[&#39;A&#39;] list.</span>
<span class="n">quals_by_base</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;A&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;T&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;/opt/bio-workshop/data/SP1.fq&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">qual</span> <span class="o">=</span> <span class="n">line</span>
        <span class="c"># update quals_by_base here since we have seq and qual</span>
        <span class="c"># use zip/izip</span>
        <span class="o">...</span>
<span class="c"># outside the loop calculate the avg base quality:</span>
<span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">integer_quals</span> <span class="ow">in</span> <span class="n">quals_by_base</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mean_quals</span> <span class="o">=</span> <span class="n">XXX_FIX_ME_XXX</span> <span class="c"># remember to float()</span>
    <span class="k">print</span> <span class="n">base</span><span class="p">,</span> <span class="n">mean_quals</span>
</pre></div>
</div>
</div>
<div class="section" id="exercises">
<h2>exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#exercises" title="Slides">§</a></h2>
<ul class="simple">
<li>do previous exercise without a list. instead storing running sum and count of
quals and using that at the end.</li>
<li>look at xrange, the lazy version of range</li>
<li>how can you implement your own version of enumerate using izip and xrange?</li>
<li>clean up some of your homeworks using the simpler fastq parsing.</li>
<li>look at the itertools module (<a class="reference external" href="http://docs.python.org/2/library/itertools.html">http://docs.python.org/2/library/itertools.html</a>)</li>
</ul>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-11.html#resources" title="Slides">§</a></h2>
<ul class="simple">
<li>idiomatic python: <a class="reference external" href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html">http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html</a></li>
<li>itertools: <a class="reference external" href="http://naiquevin.github.io/a-look-at-some-of-pythons-useful-itertools.html">http://naiquevin.github.io/a-look-at-some-of-pythons-useful-itertools.html</a></li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/Classes/class-11.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014, Jay Hesselberth.<br/>
      Last updated on Aug 29, 2014.<br/>
    </p>
  </div>
</footer>
  </body>
</html>