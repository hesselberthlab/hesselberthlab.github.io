

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Problem Set 3 &mdash; Genome Informatics Workshop 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Genome Informatics Workshop 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Problem Sets" href="../../Problem_Sets.html"/>
        <link rel="next" title="Problem Set 4" href="../problem_set_4/problem_set_4.html"/>
        <link rel="prev" title="Problem Set 2" href="../problem_set_2/problem_set_2.html"/> 

<!-- Google Analytics tracking code -->
<!--        DO NOT REMOVE           -->
<!--           JRH                  -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47837611-1', 'ucd-bioworkshop.github.io');
  ga('send', 'pageview');

</script>



  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> Genome Informatics Workshop</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Syllabus.html">Syllabus (MOLB FIXME)</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Classes.html">Class list</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-1.html">Class 1 : Virtual Machine (VM) and Linux Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-2.html">Class 2 : The command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-3.html">Class 3 : The command-line (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-4.html">Class 4 : awk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-5.html">Class 5 : Working in a cluster environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-6.html">Class 6 : Working in a cluster environment (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-7.html">Class 7 : Python : Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-8.html">Class 8 : Python : Basics (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-9.html">Class 9 : Python Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-10.html">Class 10 : Applied Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-11.html">Class 11 : Python Idioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-12.html">Class 12 : The ENCODE Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-13.html">Class 13 : BEDtools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-14.html">Class 14 : ChIP-seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-15.html">Class 15 : ChIP-seq / DNase I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-16.html">Class 16: Genomic Analysis Vignettes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-17.html">Class 17 : Bash and Bam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-18.html">Class 18 : R : Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-19.html">Class 19 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-20.html">Class 20 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-21.html">Class 21 : R : DataFrames &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-22.html">Class 22 : R : Data Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-23.html">Class 23 : RNA-Seq I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-24.html">Class 24 : RNA-Seq II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-25.html">Class 25 : Exome-Seq - Alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-26.html">Class 26 : Exome-Seq - Variants</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Problem_Sets.html">Problem Sets</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../problem_set_1/problem_set_1.html">Problem Set 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_2/problem_set_2.html">Problem Set 2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Problem Set 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_4/problem_set_4.html">Problem Set 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_5/problem_set_5.html">Problem Set 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_6/problem_set_6.html">Problem Set 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Set_Keys.html">Problem Set : KEYS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Miscellaneous.html">Miscellaneous</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/commands.html">Reference: list of commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/data.html">Sample Data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/tips.html">Programming Tips &amp; Tricks</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Genome Informatics Workshop</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../Problem_Sets.html">Problem Sets</a> &raquo;</li>
      
    <li>Problem Set 3</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/Problem_Sets/problem_set_3/problem_set_3.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="problem-set-3">
<span id="id1"></span><h1>Problem Set 3<a class="headerlink" href="#problem-set-3" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-set-3" title="Slides">§</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Due date:</th><td class="field-body">2014 Feb 21 at 9 PM MST</td>
</tr>
</tbody>
</table>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#overview" title="Slides">§</a></h2>
<p>For this quiz you will write programs in Python to analyze data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Continue to use the organization scheme that we learned about in
<a class="reference internal" href="../problem_set_1/problem_set_1.html#problem-set-1"><em>Problem Set 1</em></a>. Part of our evaluation
will include whether you are developing good organizational habits.</p>
</div>
<p>Create a <tt class="docutils literal"><span class="pre">run.sh</span></tt> file that executes the commands for each problem and
writes out each result in a dated directory.</p>
</div>
<div class="section" id="problem-1-bed-files">
<h2>Problem 1 (BED files)<a class="headerlink" href="#problem-1-bed-files" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-1-bed-files" title="Slides">§</a></h2>
<p>Use Python to perform a similar tasks as Problem Set 2, where you used
<tt class="docutils literal"><span class="pre">awk</span></tt>. Write a Python program to read the lamina.bed file and report the
following:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">What is the region with the largest start position (2nd column) <strong>for
each</strong> chromosome in <cite>lamina.bed</cite>? (<strong>5 points</strong>)</p>
</li>
<li><p class="first">What is the region with the largest end position on chrY in
lamina.bed? (<strong>5 points</strong>) Report as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chrom</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">start</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">end</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">value</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">region_length</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>Download the bed file here: <a class="reference internal" href="../../misc/data.html#bed-file"><em>BED format</em></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See end of this page for the solution to question 1.</p>
</div>
</div>
<div class="section" id="problem-2-fastq-files">
<h2>Problem 2 (FASTQ files)<a class="headerlink" href="#problem-2-fastq-files" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-2-fastq-files" title="Slides">§</a></h2>
<p>Use Python to read a file in FASTQ format. FASTQ records are comprised of
4 sections; in this case each section will be on a unique line:</p>
<div class="highlight-python"><div class="highlight"><pre>@cluster_2:UMI_ATTCCG             # record name
TTTCCGGGGCACATAATCTTCAGCCGGGCGC   # DNA sequence
+                                 # empty line; starts with &#39;+&#39;
9C;=;=&lt;9@4868&gt;9:67AA&lt;9&gt;65&lt;=&gt;591   # phred-scaled quality scores
</pre></div>
</div>
<p>Download the fastq file here: <a class="reference internal" href="../../misc/data.html#fastq-file"><em>FASTQ format</em></a></p>
<p>Write a Python program to parse the FASTQ records and report the
following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Which of the first 10 sequence records has the largest number of &#8216;C&#8217;
residues in the sequence? Report its record name (<strong>5 points</strong>).</li>
<li>For each of the first 10 records, Covert each character in the
quality score to a number, and sum the numbers. Use <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#ord" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">ord()</span></tt></a>
to convert characters to numbers (<strong>5 points</strong>).</li>
<li>Use the Python <a class="reference external" href="http://docs.python.org/2.7/library/collections.html#collections.Counter" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">Counter</span></tt></a> to count unique
sequences in the Fastq file. Report the top ten most abundant
sequences in the Fastq file (<strong>5 points</strong>).</li>
<li>Report the revese complement of each of the first 10 sequences (<strong>5
points</strong>)</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reverse complement of <tt class="docutils literal"><span class="pre">5'-AGCTCGTA-3''</span></tt> is <tt class="docutils literal"><span class="pre">5'-TACGAGCT-3'</span></tt></p>
</div>
</div>
<div class="section" id="problem-set-submission">
<h2>Problem Set Submission<a class="headerlink" href="#problem-set-submission" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-set-submission" title="Slides">§</a></h2>
<p>Submit your problem set as a tar file to Canvas
(<a class="reference internal" href="../../Problem_Sets.html#problem-set-submission"><em>Problem Set Submission</em></a>).</p>
<div class="section" id="question-1">
<h3>Question 1<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#question-1" title="Slides">§</a></h3>
<p>Here is one way to answer question 1. Note that we could also take
advantage of the fact that the file is sorted so the largest start
will always be the last line for each chromosome. Instead, here we
store the largest start we&#8217;ve seen so far, along with the value
in a dictionary keyed by chromosome.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">bedfile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">largest_by_chrom</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">bedfile</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">):</span> <span class="k">continue</span>
    <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="c"># hint for question 2. if we wanted to just get chrY, we could add...</span>
    <span class="c"># if chrom != &quot;chrY&quot;: continue</span>

    <span class="c"># we haven&#39;t seen it before, so it has to be the largest</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">largest_by_chrom</span><span class="p">:</span>
        <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># we have to check if the current start is greater</span>
        <span class="c"># than the one we&#39;ve stored.</span>
        <span class="n">largest_chrom</span><span class="p">,</span> <span class="n">largest_start</span><span class="p">,</span> <span class="n">largest_end</span><span class="p">,</span> <span class="n">largest_value</span> \
                                               <span class="o">=</span> <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">largest_start</span><span class="p">:</span>
            <span class="c"># if it is, then we store a new region</span>
            <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="c"># see what it looks like:</span>
<span class="c"># print largest_by_chrom</span>
<span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">largest_by_chrom</span><span class="p">:</span>
    <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span>
    <span class="k">print</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../problem_set_4/problem_set_4.html" class="btn btn-neutral float-right" title="Problem Set 4"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../problem_set_2/problem_set_2.html" class="btn btn-neutral" title="Problem Set 2"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Brent Pedersen, Jay Hesselberth.
      Last updated on Aug 24, 2014.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>