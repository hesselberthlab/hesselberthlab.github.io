<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Problem Set 3 &mdash; Genome Informatics Workshop 0.2 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.1.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Genome Informatics Workshop 0.2 documentation" href="../../index.html" />
    <link rel="up" title="Problem Sets" href="../../Problem_Sets.html" />
    <link rel="next" title="Problem Set 4" href="../problem_set_4/problem_set_4.html" />
    <link rel="prev" title="Problem Set 2" href="../problem_set_2/problem_set_2.html" /> 

<!-- Google Analytics tracking code -->
<!--        DO NOT REMOVE           -->
<!--           JRH                  -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47837611-1', 'ucd-bioworkshop.github.io');
  ga('send', 'pageview');

</script>


  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/dna-glyph.png">
          Genome Informatics Workshop</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://hesselberthlab.github.io">Hesselberth lab</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Genome Informatics Workshop <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Classes.html">Class list</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Problem_Sets.html">Problem Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Miscellaneous.html">Miscellaneous</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Problem Set 3</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#problem-1-bed-files">Problem 1 (BED files)</a></li>
<li><a class="reference internal" href="#problem-2-fastq-files">Problem 2 (FASTQ files)</a></li>
<li><a class="reference internal" href="#problem-set-submission">Problem Set Submission</a><ul>
<li><a class="reference internal" href="#question-1">Question 1</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="problem-set-3">
<span id="id1"></span><h1>Problem Set 3<a class="headerlink" href="#problem-set-3" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-set-3" title="Slides">§</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Due date:</th><td class="field-body">2014 Feb 21 at 9 PM MST</td>
</tr>
</tbody>
</table>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#overview" title="Slides">§</a></h2>
<p>For this quiz you will write programs in Python to analyze data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Continue to use the organization scheme that we learned about in
<a class="reference internal" href="../problem_set_1/problem_set_1.html#problem-set-1"><em>Problem Set 1</em></a>. Part of our evaluation
will include whether you are developing good organizational habits.</p>
</div>
<p>Create a <tt class="docutils literal"><span class="pre">run.sh</span></tt> file that executes the commands for each problem and
writes out each result in a dated directory.</p>
</div>
<div class="section" id="problem-1-bed-files">
<h2>Problem 1 (BED files)<a class="headerlink" href="#problem-1-bed-files" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-1-bed-files" title="Slides">§</a></h2>
<p>Use Python to perform a similar tasks as Problem Set 2, where you used
<tt class="docutils literal"><span class="pre">awk</span></tt>. Write a Python program to read the lamina.bed file and report the
following:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">What is the region with the largest start position (2nd column) <strong>for
each</strong> chromosome in <cite>lamina.bed</cite>? (<strong>5 points</strong>)</p>
</li>
<li><p class="first">What is the region with the largest end position on chrY in
lamina.bed? (<strong>5 points</strong>) Report as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chrom</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">start</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">end</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">value</span> <span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span> <span class="n">region_length</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>Download the bed file here: <a class="reference internal" href="../../misc/data.html#bed-file"><em>BED format</em></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See end of this page for the solution to question 1.</p>
</div>
</div>
<div class="section" id="problem-2-fastq-files">
<h2>Problem 2 (FASTQ files)<a class="headerlink" href="#problem-2-fastq-files" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-2-fastq-files" title="Slides">§</a></h2>
<p>Use Python to read a file in FASTQ format. FASTQ records are comprised of
4 sections; in this case each section will be on a unique line:</p>
<div class="highlight-python"><div class="highlight"><pre>@cluster_2:UMI_ATTCCG             # record name
TTTCCGGGGCACATAATCTTCAGCCGGGCGC   # DNA sequence
+                                 # empty line; starts with &#39;+&#39;
9C;=;=&lt;9@4868&gt;9:67AA&lt;9&gt;65&lt;=&gt;591   # phred-scaled quality scores
</pre></div>
</div>
<p>Download the fastq file here: <a class="reference internal" href="../../misc/data.html#fastq-file"><em>FASTQ format</em></a></p>
<p>Write a Python program to parse the FASTQ records and report the
following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Which of the first 10 sequence records has the largest number of &#8216;C&#8217;
residues in the sequence? Report its record name (<strong>5 points</strong>).</li>
<li>For each of the first 10 records, Covert each character in the
quality score to a number, and sum the numbers. Use <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#ord" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">ord()</span></tt></a>
to convert characters to numbers (<strong>5 points</strong>).</li>
<li>Use the Python <a class="reference external" href="http://docs.python.org/2.7/library/collections.html#collections.Counter" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">Counter</span></tt></a> to count unique
sequences in the Fastq file. Report the top ten most abundant
sequences in the Fastq file (<strong>5 points</strong>).</li>
<li>Report the revese complement of each of the first 10 sequences (<strong>5
points</strong>)</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reverse complement of <tt class="docutils literal"><span class="pre">5'-AGCTCGTA-3''</span></tt> is <tt class="docutils literal"><span class="pre">5'-TACGAGCT-3'</span></tt></p>
</div>
</div>
<div class="section" id="problem-set-submission">
<h2>Problem Set Submission<a class="headerlink" href="#problem-set-submission" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#problem-set-submission" title="Slides">§</a></h2>
<p>Submit your problem set as a tar file to Canvas
(<a class="reference internal" href="../../Problem_Sets.html#problem-set-submission"><em>Problem Set Submission</em></a>).</p>
<div class="section" id="question-1">
<h3>Question 1<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem_set_3/problem_set_3.html#question-1" title="Slides">§</a></h3>
<p>Here is one way to answer question 1. Note that we could also take
advantage of the fact that the file is sorted so the largest start
will always be the last line for each chromosome. Instead, here we
store the largest start we&#8217;ve seen so far, along with the value
in a dictionary keyed by chromosome.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">bedfile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">largest_by_chrom</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">bedfile</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">):</span> <span class="k">continue</span>
    <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="c"># hint for question 2. if we wanted to just get chrY, we could add...</span>
    <span class="c"># if chrom != &quot;chrY&quot;: continue</span>

    <span class="c"># we haven&#39;t seen it before, so it has to be the largest</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">largest_by_chrom</span><span class="p">:</span>
        <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># we have to check if the current start is greater</span>
        <span class="c"># than the one we&#39;ve stored.</span>
        <span class="n">largest_chrom</span><span class="p">,</span> <span class="n">largest_start</span><span class="p">,</span> <span class="n">largest_end</span><span class="p">,</span> <span class="n">largest_value</span> \
                                               <span class="o">=</span> <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">largest_start</span><span class="p">:</span>
            <span class="c"># if it is, then we store a new region</span>
            <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="c"># see what it looks like:</span>
<span class="c"># print largest_by_chrom</span>
<span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">largest_by_chrom</span><span class="p">:</span>
    <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">largest_by_chrom</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span>
    <span class="k">print</span> <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/Problem_Sets/problem_set_3/problem_set_3.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2014, Jay Hesselberth.<br/>
      Last updated on Aug 29, 2014.<br/>
    </p>
  </div>
</footer>
  </body>
</html>