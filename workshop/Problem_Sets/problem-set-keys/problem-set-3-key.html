

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Problem Set 3 : KEY &mdash; Genome Informatics Workshop 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../../',
        VERSION:'0.1',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Genome Informatics Workshop 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Problem Set : KEYS" href="../Problem_Set_Keys.html"/>
        <link rel="next" title="Problem Set 4 : KEY" href="problem-set-4-key.html"/>
        <link rel="prev" title="Problem Set 2 : KEY" href="problem-set-2-key.html"/> 

<!-- Google Analytics tracking code -->
<!--        DO NOT REMOVE           -->
<!--           JRH                  -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47837611-1', 'ucd-bioworkshop.github.io');
  ga('send', 'pageview');

</script>



  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="icon icon-home"> Genome Informatics Workshop</a>
        <form class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Syllabus.html">Syllabus (MOLB FIXME)</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Classes.html">Class list</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-1.html">Class 1 : Virtual Machine (VM) and Linux Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-2.html">Class 2 : The command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-3.html">Class 3 : The command-line (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-4.html">Class 4 : awk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-5.html">Class 5 : Working in a cluster environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-6.html">Class 6 : Working in a cluster environment (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-7.html">Class 7 : Python : Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-8.html">Class 8 : Python : Basics (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-9.html">Class 9 : Python Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-10.html">Class 10 : Applied Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-11.html">Class 11 : Python Idioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-12.html">Class 12 : The ENCODE Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-13.html">Class 13 : BEDtools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-14.html">Class 14 : ChIP-seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-15.html">Class 15 : ChIP-seq / DNase I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-16.html">Class 16: Genomic Analysis Vignettes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-17.html">Class 17 : Bash and Bam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-18.html">Class 18 : R : Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-19.html">Class 19 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-20.html">Class 20 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-21.html">Class 21 : R : DataFrames &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-22.html">Class 22 : R : Data Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-23.html">Class 23 : RNA-Seq I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-24.html">Class 24 : RNA-Seq II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-25.html">Class 25 : Exome-Seq - Alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Classes/class-26.html">Class 26 : Exome-Seq - Variants</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Problem_Sets.html">Problem Sets</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../problem_set_1/problem_set_1.html">Problem Set 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_2/problem_set_2.html">Problem Set 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_3/problem_set_3.html">Problem Set 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_4/problem_set_4.html">Problem Set 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_5/problem_set_5.html">Problem Set 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_set_6/problem_set_6.html">Problem Set 6</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Problem_Set_Keys.html">Problem Set : KEYS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Miscellaneous.html">Miscellaneous</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/commands.html">Reference: list of commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/data.html">Sample Data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/tips.html">Programming Tips &amp; Tricks</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Genome Informatics Workshop</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../../index.html">Docs</a> &raquo;</li>
  <li><a href="">Problem Set 3 : KEY</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="problem-set-3-key">
<span id="id1"></span><h1>Problem Set 3 : KEY<a class="headerlink" href="#problem-set-3-key" title="Permalink to this headline">¶</a><a class="headerlink" href="../../slides/Problem_Sets/problem-set-keys/problem-set-3-key.html#problem-set-3-key" title="Slides">§</a></h1>
<p>Here is bash script that runs the following two Python programs:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /usr/bin/env bash</span>

<span class="c"># run script for Problem Set 3 keys</span>

<span class="nv">project</span><span class="o">=</span><span class="s2">&quot;$HOME/devel/bio-workshop/problem-set-keys/problem-set-3&quot;</span>
<span class="nv">bedfile</span><span class="o">=</span><span class="s2">&quot;$project/data/2014-02-12/lamina.bed&quot;</span>
<span class="nv">fastqfile</span><span class="o">=</span><span class="s2">&quot;$project/data/2014-02-17/SP1.fq&quot;</span>

<span class="nv">result</span><span class="o">=</span><span class="s2">&quot;$project/results/2014-02-17&quot;</span>
<span class="nv">results</span><span class="o">=</span><span class="s2">&quot;$project/results/2014-02-17/result.tab&quot;</span>

<span class="k">if</span> <span class="o">[</span> ! -d <span class="nv">$result</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>mkdir -p <span class="nv">$result</span>
<span class="k">fi</span>

<span class="c"># run out of current directory</span>
python problem-1-bedfile.py <span class="nv">$bedfile</span> &gt;&gt; <span class="nv">$results</span>
python problem-2-fastqfile.py <span class="nv">$fastqfile</span> &gt;&gt; <span class="nv">$results</span>
</pre></div>
</td></tr></table></div>
<p>Here is the Python code for Problem 1:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Problem Set 3 (BED)</span>
<span class="sd">===================</span>

<span class="sd">Problem 1.1</span>
<span class="sd">-----------</span>
<span class="sd">What is the region with the largest start position (2nd column) for each</span>
<span class="sd">chromosome in lamina.bed?</span>

<span class="sd">Problem 1.2</span>
<span class="sd">-----------</span>
<span class="sd">What is the region with the largest end position on chrY in lamina.bed?</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;error: specify bed file&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># --- main program -------------------------------------------</span>

<span class="n">bedfilename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">regions_1_1</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">regions_1_2</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">bedfilename</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">):</span> <span class="k">continue</span>

    <span class="c"># get fields and coerce</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">chrom</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="c"># problem 1.1: add starts to the list</span>
    <span class="n">regions_1_1</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

    <span class="c"># problem 1.2: similar to problem 1.1, except add tuples with end in</span>
    <span class="c"># the first position for max() to examine. also want to keep the score</span>
    <span class="c"># for reporting later</span>
    <span class="n">regions_1_2</span><span class="p">[</span><span class="n">chrom</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">end</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">score</span><span class="p">))</span>

<span class="c"># --- print results ---------------------------------------------------</span>

<span class="k">print</span> <span class="s">&quot;Problem 1.1: largest start positions for each chrom:</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions_1_1</span><span class="p">):</span>

    <span class="n">max_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">regions_1_1</span><span class="p">[</span><span class="n">chrom</span><span class="p">])</span> 

    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">chrom</span><span class="p">,</span> <span class="n">max_start</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">fields</span><span class="p">))</span>

<span class="c"># blank line</span>
<span class="k">print</span>

<span class="k">print</span> <span class="s">&quot;Problem 1.2: region with largest end position on chrY, region &quot;</span> \
      <span class="s">&quot;size in 5th col:</span><span class="se">\n</span><span class="s">&quot;</span>

<span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions_1_2</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">chrom</span> <span class="o">!=</span> <span class="s">&#39;chrY&#39;</span><span class="p">:</span> <span class="k">continue</span>

    <span class="n">max_end</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">regions_1_2</span><span class="p">[</span><span class="n">chrom</span><span class="p">])</span> 
    <span class="n">region_size</span> <span class="o">=</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">max_end</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">region_size</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">fields</span><span class="p">))</span>

<span class="c"># blank line</span>
<span class="k">print</span>
</pre></div>
</td></tr></table></div>
<p>Here is the Python code for Problem 2:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Problem Set 3 (FASTQ)</span>
<span class="sd">=====================</span>

<span class="sd">Problem 2.1</span>
<span class="sd">-----------</span>
<span class="sd">Which of the first 10 sequence records has the largest number of &#39;C&#39;</span>
<span class="sd">residues in the sequence? Report its record name.</span>

<span class="sd">Problem 2.2</span>
<span class="sd">-----------</span>
<span class="sd">For each of the first 10 records, Covert each character in the quality</span>
<span class="sd">score to a number, and sum the numbers. Use ord() to convert characters to</span>
<span class="sd">numbers.</span>

<span class="sd">Problem 2.3</span>
<span class="sd">-----------</span>
<span class="sd">Use the Python Counter to count unique sequences in the Fastq file. Report</span>
<span class="sd">the top ten most abundant sequences in the Fastq file</span>

<span class="sd">Problem 2.4</span>
<span class="sd">-----------</span>
<span class="sd">Report the revese complement of each of the first 10 sequences.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;error: specify fastq file&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fastqfilename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># --- define functions -------------------------------------------</span>
<span class="k">def</span> <span class="nf">parse_fastq</span><span class="p">(</span><span class="n">fastqfile</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; takes a file handle input and returns records as dicts &#39;&#39;&#39;</span>
    <span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># Keep track of lines in file</span>
    
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fastqfile</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">line_num</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Removes @ character from record name</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>  

        <span class="k">elif</span> <span class="n">line_num</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>      
            <span class="n">seq</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">line_num</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">quals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">yield</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;seq&#39;</span><span class="p">:</span><span class="n">seq</span><span class="p">,</span> <span class="s">&#39;quals&#39;</span><span class="p">:</span><span class="n">quals</span><span class="p">}</span>

        <span class="c"># line incremented with every iteration of loop</span>
        <span class="n">line_num</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">reverse_comp</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; reverse complement a sequence. return in 5&#39;-&gt;3&#39; direction &#39;&#39;&#39;</span>
    <span class="n">rc_seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;T&#39;</span><span class="p">:</span>
            <span class="n">rc_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">rc_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;G&#39;</span><span class="p">:</span>
            <span class="n">rc_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;C&#39;</span><span class="p">:</span>
            <span class="n">rc_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rc_seq</span><span class="p">)</span>

<span class="c"># --- main program -------------------------------------------</span>

<span class="c"># keep track of record number for first 10</span>
<span class="n">seen_records</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">record_limit</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c"># problem 2.1 data</span>
<span class="n">scores_2_1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># problem 2.2 data</span>
<span class="n">quals_2_2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># problem 2.4 data</span>
<span class="n">quals_2_4</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">parse_fastq</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fastqfilename</span><span class="p">)):</span>

    <span class="n">nuc_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s">&#39;seq&#39;</span><span class="p">])</span>

    <span class="c"># add a tuple of (C_count, name) to scores</span>
    <span class="n">scores_2_1</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nuc_counts</span><span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">],</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]))</span>

    <span class="c"># problem 2.2 data</span>
    <span class="n">qual_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;quals&#39;</span><span class="p">]])</span>
    <span class="c"># covert to str for printing later</span>
    <span class="n">quals_2_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">qual_sum</span><span class="p">))</span>
   
    <span class="n">quals_2_4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reverse_comp</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s">&#39;seq&#39;</span><span class="p">]))</span>

    <span class="n">seen_records</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">seen_records</span> <span class="o">==</span> <span class="n">record_limit</span><span class="p">:</span>
        <span class="k">break</span>

<span class="c"># problem 2.3 data</span>
<span class="n">seqs</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">parse_fastq</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">fastqfilename</span><span class="p">)):</span>
    <span class="n">seqs</span><span class="p">[</span><span class="n">record</span><span class="p">[</span><span class="s">&#39;seq&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span> 

<span class="c"># --- print results ---------------------------------------------------</span>

<span class="k">print</span> <span class="s">&quot;Problem 2.1: the record name with the highest &#39;C&#39; count is:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores_2_1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># blank line</span>
<span class="k">print</span>

<span class="k">print</span> <span class="s">&quot;Problem 2.2: sums of the first 10 quality scores in ord format:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quals_2_2</span><span class="p">)</span>

<span class="c"># blank line</span>
<span class="k">print</span>

<span class="k">print</span> <span class="s">&quot;Problem 2.3:  most common sequences in the file:&quot;</span>
<span class="k">for</span> <span class="n">seq</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">seqs</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">seq</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span><span class="n">count</span>

<span class="c"># blank line</span>
<span class="k">print</span>

<span class="k">print</span> <span class="s">&quot;Problem 2.4: reverse complements of the first 10 seqs:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="k">print</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quals_2_4</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The output of the run script looks like this:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71</pre></div></td><td class="code"><div class="highlight"><pre>Problem 1.1: largest start positions for each chrom:

chr1	245647839
chr10	129141333
chr11	132322333
chr12	129934486
chr13	110796751
chr14	103464302
chr15	99670855
chr16	82174586
chr17	68901867
chr18	73058130
chr19	61378765
chr2	239997824
chr20	58104509
chr21	39740537
chr22	31610031
chr3	195897445
chr4	190367794
chr5	180228411
chr6	166444291
chr7	158368912
chr8	136731831
chr9	124952737
chrX	153719866
chrY	15475619

Problem 1.2: region with largest end position on chrY, region size in 5th col:

chrY	15475619	19472504	0.8138424821	3996885

Problem 2.1: the record name with the highest &#39;C&#39; count is:

cluster_36:UMI_AACAGA

Problem 2.2: sums of the first 10 quality scores in ord format:

1807
1472
1958
1650
1969
1682
1739
2018
1698
1947
Problem 2.3:  most common sequences in the file:
CCCCCCCCCAAATCGGAAAAACACACCCCTA 	3
TCCCCCCCCCAAATCGGAAAAACACACCCCC 	3
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT 	2
CCCCCCCAGATCGGAAAAGCACACGCCTGAA 	2
GCCCCCCCCCAAATCGGAAAAACACACCCCC 	2
GGTTGAGCACAGGGTACTTTATTGATGGTAC 	2
GGCTTTGCAACCATACTCCCCCCGGAACCCA 	2
CAGCTTTGCAACCATACTCCCCCCGGAACCC 	2
CTCAGCACCCATTGTAAATTATTTGTGGATG 	1
CCCCCTTAAATAGCTGTTTATTTGGCCCCAG 	1

Problem 2.4: reverse complements of the first 10 seqs:

GCGCCCGGCTGAAGATTATGTGCCCCGGAAA
GCTCTCCCGTTCGGAGAGTATTGCAAGGATA
CTTGCTCTTCAATAAAATGATCTTAAACTGC
GATCTGGGGGTGTAATAAATTTTGCAATGCC
CTGGGGCCAAATAAACAGCTATTTAAGGGGG
GTGCTCTTCCGATCTAGGAGTTTTTGCAAGA
GGGGGTGTGTTTTTCCGATTTGGGGGGGGGA
AAAGACCTTTAATAAAATTTTGTACAAAGAC
GCGTGTGTTTTTCCGATCTGGTGATGGAAGG
AGATTTTTAAATAAAGATTGGATTATAACTC
</pre></div>
</td></tr></table></div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="problem-set-4-key.html" class="btn btn-neutral float-right" title="Problem Set 4 : KEY"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="problem-set-2-key.html" class="btn btn-neutral" title="Problem Set 2 : KEY"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2014, Brent Pedersen, Jay Hesselberth.
    Last updated on Aug 25, 2014.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>