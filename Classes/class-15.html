

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Class 15 : ChIP-seq / DNase I &mdash; Genome Informatics Workshop 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Genome Informatics Workshop 0.1 documentation" href="../index.html"/>
        <link rel="up" title="Class list" href="../Classes.html"/>
        <link rel="next" title="Class 16: Genomic Analysis Vignettes" href="class-16.html"/>
        <link rel="prev" title="Class 14 : ChIP-seq" href="class-14.html"/> 

<!-- Google Analytics tracking code -->
<!--        DO NOT REMOVE           -->
<!--           JRH                  -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47837611-1', 'ucd-bioworkshop.github.io');
  ga('send', 'pageview');

</script>



  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Genome Informatics Workshop</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Syllabus.html">Syllabus (MOLB FIXME)</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Classes.html">Class list</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="class-1.html">Class 1 : Virtual Machine (VM) and Linux Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-2.html">Class 2 : The command-line</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-3.html">Class 3 : The command-line (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-4.html">Class 4 : awk</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-5.html">Class 5 : Working in a cluster environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-6.html">Class 6 : Working in a cluster environment (part 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-7.html">Class 7 : Python : Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-8.html">Class 8 : Python : Basics (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-9.html">Class 9 : Python Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-10.html">Class 10 : Applied Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-11.html">Class 11 : Python Idioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-12.html">Class 12 : The ENCODE Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-13.html">Class 13 : BEDtools</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-14.html">Class 14 : ChIP-seq</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Class 15 : ChIP-seq / DNase I</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-16.html">Class 16: Genomic Analysis Vignettes</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-17.html">Class 17 : Bash and Bam</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-18.html">Class 18 : R : Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-19.html">Class 19 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-20.html">Class 20 : R : Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-21.html">Class 21 : R : DataFrames &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-22.html">Class 22 : R : Data Manipulation &amp; Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-23.html">Class 23 : RNA-Seq I</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-24.html">Class 24 : RNA-Seq II</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-25.html">Class 25 : Exome-Seq - Alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="class-26.html">Class 26 : Exome-Seq - Variants</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Problem_Sets.html">Problem Sets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_1/problem_set_1.html">Problem Set 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_2/problem_set_2.html">Problem Set 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_3/problem_set_3.html">Problem Set 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_4/problem_set_4.html">Problem Set 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_5/problem_set_5.html">Problem Set 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/problem_set_6/problem_set_6.html">Problem Set 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_Sets/Problem_Set_Keys.html">Problem Set : KEYS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous.html">Miscellaneous</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/commands.html">Reference: list of commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/data.html">Sample Data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/tips.html">Programming Tips &amp; Tricks</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Genome Informatics Workshop</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../Classes.html">Class list</a> &raquo;</li>
      
    <li>Class 15 : ChIP-seq / DNase I</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/Classes/class-15.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="class-15-chip-seq-dnase-i">
<h1>Class 15 : ChIP-seq / DNase I<a class="headerlink" href="#class-15-chip-seq-dnase-i" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#class-15-chip-seq-dnase-i" title="Slides">§</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Class date:</th><td class="field-body">2014 Mar 3 Monday</td>
</tr>
</tbody>
</table>
<div class="section" id="final-project">
<h2>Final Project<a class="headerlink" href="#final-project" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#final-project" title="Slides">§</a></h2>
<p>We will have a final project that is worth 15% of your grade, due on April
2.</p>
<p>We want you to come up with a question you can address with the tools you
learned in the class. You should incorporate ENCODE data into your
analysis, and you can also integrate your own data.</p>
<p>We will go over some analysis vignettes on Wed and Fri to illustrate
example final projects.</p>
</div>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#goals" title="Slides">§</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li>Connect UCSC browser to bigWig / bigBed files</li>
<li>Compare ChIP and DNase I data</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="coverage-plots-for-chip-and-dnase-i">
<h2>Coverage plots for ChIP and DNase I<a class="headerlink" href="#coverage-plots-for-chip-and-dnase-i" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#coverage-plots-for-chip-and-dnase-i" title="Slides">§</a></h2>
<p>You will want to calculate coverage plots that are appropriate for the
type of experiment. For example, in a ChIP experiment, you want to examine
the entire region covered by sequences.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ common_args</span><span class="o">=</span><span class="s2">&quot;-ibam &lt;aln.bam&gt; -g &lt;chrom.size&gt; -bg&quot;</span>
<span class="nv">$ </span>bedtools genomecov <span class="nv">$common_args</span> &gt; coverage.bg
</pre></div>
</div>
<p>But in a DNase I mapping experiment, you only want to know the exact
position where DNase I cut the DNA, i.e. the 5&#8217; position. Use the <tt class="docutils literal"><span class="pre">-5</span></tt>
flag in bedtools to only count 5&#8217; positions.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ common_args</span><span class="o">=</span><span class="s2">&quot;-ibam &lt;aln.bam&gt; -g &lt;chrom.size&gt; -bg&quot;</span>
<span class="nv">$ </span>bedtools genomecov <span class="nv">$common_args</span> -5 &gt; coverage.5p.bg
</pre></div>
</div>
</div>
<div class="section" id="chip-seq-dnase-i-data">
<h2>ChIP-seq / DNase I data<a class="headerlink" href="#chip-seq-dnase-i-data" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#chip-seq-dnase-i-data" title="Slides">§</a></h2>
<p>Compare ChIP-seq and DNase I data in browser <a class="footnote-reference" href="#id2" id="id1">[1]</a>.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Genome Browser Session <a class="reference external" href="http://goo.gl/jx6fCA">http://goo.gl/jx6fCA</a></td></tr>
</tbody>
</table>
<div class="section" id="plot-coverage-with-the-genome-browser">
<h3>Plot coverage with the Genome Browser<a class="headerlink" href="#plot-coverage-with-the-genome-browser" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#plot-coverage-with-the-genome-browser" title="Slides">§</a></h3>
<p>Use the UCSC Genome Browser to plot your data. Files in bedGraph format
can be large, so UCSC created a facility for posting binary format data in
a web-accessible directory that the browser can read.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># NOTE: bedGraph and BED files must be sorted first</span>

<span class="c"># convert bedGraph to binary format (bigWig)</span>
<span class="nv">$ </span>bedGraphToBigWig &lt;coverage.bg&gt; &lt;chrom.sizes&gt; &lt;coverage.bw&gt;

<span class="c"># convert BED to binary format (bigBed)</span>
<span class="nv">$ </span>bedToBigBed &lt;peaks.bed&gt; &lt;chrom.sizes&gt; &lt;peaks.bb&gt;
</pre></div>
</div>
</div>
<div class="section" id="posting-your-data">
<h3>Posting your data<a class="headerlink" href="#posting-your-data" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#posting-your-data" title="Slides">§</a></h3>
<p>We need to set up your accounts so that you will be able to see data
posted in your account. When this is setup, you should be able to put
files in:</p>
<div class="highlight-python"><div class="highlight"><pre>$HOME/public_html/file.html
</pre></div>
</div>
<p>and be able to see them like:</p>
<div class="highlight-python"><div class="highlight"><pre>http://amc-sandbox.ucdenver.edu/~username/file.html
</pre></div>
</div>
</div>
<div class="section" id="writing-tracklines">
<h3>Writing tracklines<a class="headerlink" href="#writing-tracklines" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#writing-tracklines" title="Slides">§</a></h3>
<p>You can now write &#8220;tracklines&#8221; <a class="footnote-reference" href="#id4" id="id3">[2]</a> to tell where UCSC to find your data:</p>
<div class="highlight-python"><div class="highlight"><pre># URL = http://amc-sandbox.ucdenver.edu/~username/path-to-binaryfile
track type=bigWig bigDataUrl=&lt;URL&gt; name=&#39;coverage&#39; color=r,g,b
track type=bigBed bigDataUrl=&lt;URL&gt; name=&#39;peaks&#39; color=r,g,b
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>UCSC Track configuration
<a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/customTrack.html#TRACK">https://genome.ucsc.edu/goldenPath/help/customTrack.html#TRACK</a></td></tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Don&#8217;t pick colors yourself, they will be ugly. <strong>Use Colorbrewer</strong>
<a class="reference external" href="http://colorbrewer2.org">http://colorbrewer2.org</a>.</p>
<p class="last">RGB colors in the <tt class="docutils literal"><span class="pre">Dark2</span></tt> and <tt class="docutils literal"><span class="pre">Set1</span></tt> qualitative palettes work
well for UCSC display.</p>
</div>
<p>There are a large number of additional options you can use in tracklines
to change their display.</p>
</div>
</div>
<div class="section" id="problem-set-questions">
<h2>Problem Set Questions<a class="headerlink" href="#problem-set-questions" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/Classes/class-15.html#problem-set-questions" title="Slides">§</a></h2>
<p>Anybody have questions on the problem set?</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="class-16.html" class="btn btn-neutral float-right" title="Class 16: Genomic Analysis Vignettes"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="class-14.html" class="btn btn-neutral" title="Class 14 : ChIP-seq"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Brent Pedersen, Jay Hesselberth.
      Last updated on Aug 24, 2014.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>